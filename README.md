## Кейс: организация полного цикла работы с данными для аналитической отчётности

### Цель 

Построить систему аналитической отчётности, которая автоматизирует сбор и обработку данных из разнородных источников и будет предоставлять руководству ежемесячные интерактивные отчёты с ключевыми метриками.

### Этапы реализации

**1. Определение и настройка источников данных**  
Основные данные, необходимые для аналитики хранятся в 1С:Управление торговлей и 1С:Бухгалтерия предприятия. Для выгрузки данных из них настроил необходимые конфигурации отчетов и 
ежемесячную рассылку этих отчётов из 1С. Также данные хранятся в нескольких Excel‑файлах, которые заполняются пользователями вручную.

**2. Подготовка данных**  
Разработал процессы в Pentaho Data Integration для:
  - загрузки данных
  - приведения их к единому формату
  - обогащения данных дополнительной информацией
  - очистки от дублей, ошибок и несоответствий

**3. Организация DWH**  
Развёрнул базу на PostgreSQL для хранения подготовленных аналитических данных и настроил процессы загрузки из Pentaho в базу.

**4. Моделирование и визуализация в Power BI**  
В Power BI Desktop создал:
  - подключения к DWH и запросы для загрузки, агрегации и преобразования данных
  - модели данных с необходимыми связями и иерархиями
  - расчёты ключевых метрик с использованием DAX
Разработал интерактивные дашборды с визуализацией ключевых метрик с возможностью фильтрации по датам и филиалам.
Отчёты опубликовал в Power BI Service и обеспечил доступ для пользователей.

<p align="center">
  <img src="https://github.com/iaidarf/data-warehouse-etl-bi/blob/main/scheme.png" width=70% /> 
  <br>
  <em>Схема этапов реализации</em>
</p>

<p align="center">
  <img src="https://github.com/iaidarf/data-warehouse-etl-bi/blob/main/pentaho.PNG" width=70% /> 
  <br>
  <em>Пример процесса в pentaho</em>
</p>

### Результат
  - база данных со структурированной информацией из различных источников в едином формате с возможностью быстрого построения отчетов по запросу.
  - интерактивные отчеты в Power BI для руководства, позволяющие анализировать ключевые метрики и принимать решения на основе наглядной аналитики

<p align="center">
  <img src="https://github.com/iaidarf/data-warehouse-etl-bi/blob/main/summary.png" width=50% /> 
  <br>
  <img src="https://github.com/iaidarf/data-warehouse-etl-bi/blob/main/detail.png" width=50% /> 
  <br>
  <img src="https://github.com/iaidarf/data-warehouse-etl-bi/blob/main/comparison.png" width=50% /> 
  <br>
  <em>Примеры отчетов в PowerBI</em>
</p>


**Ключевые технологии:** 1С, Excel, Pentaho Data Integration, PostgreSQL, Power BI (Power Query, DAX), Power BI Service.
